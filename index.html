<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard â€” InteligÃªncia Emocional</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>Dashboard â€¢ InteligÃªncia Emocional</h1>
    <p class="subtitle">Use os filtros e clique em "Gerar Insights IA" para atualizar o resumo.</p>
  </header>

  <!-- DIAGNÃ“STICO RÃPIDO -->
  <div id="diag" class="diag">
    <strong>DiagnÃ³stico:</strong> <span id="diag-msg">Inicializando...</span>
    <button id="diag-show-json" class="mini">Mostrar JSON</button>
  </div>

  <main class="container">
    <section class="controls">
      <div class="filter">
        <label for="sel-turma">Turma</label>
        <select id="sel-turma"><option>Todos</option></select>
      </div>

      <div class="filter">
        <label for="sel-eixo">Eixo</label>
        <select id="sel-eixo"><option>Todos</option></select>
      </div>

      <div class="filter">
        <label for="sel-month">MÃªs/Ano</label>
        <select id="sel-month"><option>Todos</option></select>
      </div>

      <div class="actions">
        <button id="btn-refresh">Atualizar agora</button>
        <button id="btn-insights">Gerar Insights IA</button>
        <span id="last-update" class="last-update"></span>
      </div>
    </section>

    <section class="grid-metrics" id="nps-grid">
      <div class="card nps-card">
        <h3>RecomendaÃ§Ã£o (NPS)</h3>
        <div class="metric" id="metric-nps-rec">â€”</div>
        <div class="help">NPS = %Promotores âˆ’ %Detratores</div>
        <div class="help small" id="nps-breakdown">
          %Detratores: <span id="nps-pct-detr">â€”</span> &nbsp; | &nbsp; %Promotores: <span id="nps-pct-prom">â€”</span>
        </div>
      </div>

      <div class="card nps-card">
        <h3>AutoavaliaÃ§Ã£o (1â€“5)</h3>
        <div class="metric" id="metric-nps-auto">â€”</div>
        <div class="help">MÃ©dia da autoavaliaÃ§Ã£o</div>
      </div>

      <div class="card nps-card">
        <h3>Professor 1 (1â€“5)</h3>
        <div class="metric" id="metric-nps-prof1">â€”</div>
        <div class="help">MÃ©dia do professor 1</div>
      </div>

      <div class="card nps-card">
        <h3>Professor 2 (1â€“5)</h3>
        <div class="metric" id="metric-nps-prof2">â€”</div>
        <div class="help">MÃ©dia do professor 2</div>
      </div>
    </section>

    <section class="charts">
      <div class="chart-card">
        <h4>ComparaÃ§Ã£o â€” Check-in (Quantidade por categoria)</h4>
        <canvas id="chart-checkin" height="220"></canvas>
        <div class="legend-inline" id="legend-checkin"></div>
      </div>

      <div class="chart-card">
        <h4>ComparaÃ§Ã£o â€” Check-out (Quantidade por categoria)</h4>
        <canvas id="chart-checkout" height="220"></canvas>
        <div class="legend-inline" id="legend-checkout"></div>
      </div>

      <div class="chart-card wide">
        <h4>Resumo das respostas abertas (IA)</h4>
        <div id="ai-summary" class="ai-box">
          <div id="insightBox">Clique em "Gerar Insights IA" para obter o resumo.</div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <small>Dados fornecidos por Apps Script â€¢ AtualizaÃ§Ã£o automÃ¡tica (45s)</small>
    </footer>
  </main>

  <!-- ======================================================================
       FALLBACK SAMPLE JSON (USADO SOMENTE SE O FETCH FALHAR)
       ======================================================================
       SubstituÃ­ aqui com o JSON que vocÃª forneceu para que vocÃª veja o dashboard
       trabalhando mesmo quando o Apps Script bloquear CORS.
    -->
  <script>
  window.SAMPLE_JSON = {
  "raw": {
    "checkin": [
      {
        "Timestamp": "2025-08-01T03:00:00.000Z",
        "Score": 0,
        "Nome completo": "Aluno 1",
        "Turma": "Turma 50",
        "Eixo": "Eixo 1",
        "Hoje vocÃª consegue reconhecer situaÃ§Ãµes que te desestabilizam e exigem maior autocontrole?": "ğŸ™‚Quase sempre, reconheÃ§o situaÃ§Ãµes que me desestabilizam, mas posso melhorar o autocontrole.",
        "Hoje Ã© â€œde boaâ€ nomear, com clareza, as emoÃ§Ãµes que vocÃª estÃ¡ sentindo?": "ğŸ˜€Sim, Ã© â€œde boaâ€ nomear as emoÃ§Ãµes que estou sentido.",
        "VocÃª consegue reconhecer caracterÃ­sticas de um comportamento autoconfiante?": "ğŸ˜€ Sim, consigo! Consigo descrever polÃ­ticas de diversidade e inclusÃ£o, bem como sua importÃ¢ncia.",
        "Hoje, como Ã© o seu relacionamento com as pessoas e sua capacidade de trabalhar em equipe?": "ğŸ™‚ Relaciono bem com as pessoas, mas trabalhar em equipe ainda Ã© um desafio."
      },
      {
        "Timestamp": "2025-08-01T03:00:00.000Z",
        "Score": 0,
        "Nome completo": "Aluno 2",
        "Turma": "Turma 50",
        "Eixo": "Eixo 1",
        "Hoje vocÃª consegue reconhecer situaÃ§Ãµes que te desestabilizam e exigem maior autocontrole?": "ğŸ˜¬Mais ou menos, reconheÃ§o situaÃ§Ãµes que me desestabilizam, mas tenho dificuldade em manter o autocontrole.",
        "Hoje Ã© â€œde boaâ€ nomear, com clareza, as emoÃ§Ãµes que vocÃª estÃ¡ sentindo?": "ğŸ™‚Quase sempre, acho que consigo nomear a maioria das minhas emoÃ§Ãµes.",
        "VocÃª consegue reconhecer caracterÃ­sticas de um comportamento autoconfiante?": "ğŸ™‚ReconheÃ§o algumas caracterÃ­sticas de um comportamento autoconfiante.",
        "Hoje, como Ã© o seu relacionamento com as pessoas e sua capacidade de trabalhar em equipe?": "ğŸ˜€Muito bom! Creio me relacionar bem com as pessoas e trabalho bem em equipe."
      }
    ],
    "checkout": [
      {
        "Timestamp": "2025-08-01T03:00:00.000Z",
        "Score": 0,
        "Nome completo": "Aluno 1",
        "Turma": "Turma 50",
        "Eixo": "Eixo 1",
        "Hoje vocÃª consegue reconhecer situaÃ§Ãµes que te desestabilizam e exigem maior autocontrole?": "ğŸ˜NÃ£o consigo, Ã© difÃ­cil reconhecer situaÃ§Ãµes que me desestabilizam.",
        "Hoje Ã© â€œde boaâ€ nomear, com clareza, as emoÃ§Ãµes que vocÃª estÃ¡ sentindo?": "ğŸ˜€Sim, Ã© â€œde boaâ€ nomear as emoÃ§Ãµes que estou sentido.",
        "VocÃª consegue reconhecer caracterÃ­sticas de um comportamento autoconfiante?": "ğŸ˜€ Sim, consigo! Consigo descrever polÃ­ticas de diversidade e inclusÃ£o, bem como sua importÃ¢ncia.",
        "Hoje, como Ã© o seu relacionamento com as pessoas e sua capacidade de trabalhar em equipe?": "ğŸ™‚ Relaciono bem com as pessoas, mas trabalhar em equipe ainda Ã© um desafio."
      },
      {
        "Timestamp": "2025-08-01T03:00:00.000Z",
        "Score": 0,
        "Nome completo": "Aluno 2",
        "Turma": "Turma 50",
        "Eixo": "Eixo 1",
        "Hoje vocÃª consegue reconhecer situaÃ§Ãµes que te desestabilizam e exigem maior autocontrole?": "ğŸ˜€Consigo! ReconheÃ§o as situaÃ§Ãµes que me desestabilizam e respondo bem as que exigem bastante autocontrole.",
        "Hoje Ã© â€œde boaâ€ nomear, com clareza, as emoÃ§Ãµes que vocÃª estÃ¡ sentindo?": "ğŸ™‚Quase sempre, acho que consigo nomear a maioria das minhas emoÃ§Ãµes.",
        "VocÃª consegue reconhecer caracterÃ­sticas de um comportamento autoconfiante?": "ğŸ™‚ReconheÃ§o algumas caracterÃ­sticas de um comportamento autoconfiante.",
        "Hoje, como Ã© o seu relacionamento com as pessoas e sua capacidade de trabalhar em equipe?": "ğŸ˜€Muito bom! Creio me relacionar bem com as pessoas e trabalho bem em equipe."
      }
    ],
    "avaliacao": [
      {
        "Carimbo de data/hora": "2025-08-09T17:44:54.000Z",
        "Nome completo": "Aluno 1",
        "Turma": "Turma 50",
        "Eixo": "Eixo 1",
        "Em uma escala de 0 a 10 o quanto vocÃª recomendaria o eixo de InteligÃªncia Emocional a um colega?": 8,
        "Em uma escala de 1 a 5, como vocÃª se autoavalia em relaÃ§Ã£o ao seu desempenho nas aulas deste mÃ³dulo?": 5,
        "Em uma escala de 1 a 5, como vocÃª avalia o professor 1 na conduÃ§Ã£o das aulas deste mÃ³dulo?": 5,
        "Em uma escala de 1 a 5, como vocÃª avalia o professor 2 na conduÃ§Ã£o das aulas deste mÃ³dulo?": 5,
        "Que bom (O que vocÃª gostou)": "Gostei da forma que nos foi apresentado cada assunto sobre inteligÃªncia emocional",
        "Que tal (O que poderia ser melhor)": "Poderia acrescentar situaÃ§Ãµes mais profundas sobre as emoÃ§Ãµes e sentimentos, algo que faria Ã s pessoas repensarem e mudarem de ponto de vista, poderia ser melhor, mas foi Ã³timo mesmo assim",
        "Que pena (O que vocÃª nÃ£o gostou)": "Eu n tenho oq reclamar, foi tudo bem feito, mas como eu disse, poderia ser melhor"
      },
      {
        "Carimbo de data/hora": "2025-08-09T17:44:54.000Z",
        "Nome completo": "Aluno 2",
        "Turma": "Turma 50",
        "Eixo": "Eixo 1",
        "Em uma escala de 0 a 10 o quanto vocÃª recomendaria o eixo de InteligÃªncia Emocional a um colega?": 1,
        "Em uma escala de 1 a 5, como vocÃª se autoavalia em relaÃ§Ã£o ao seu desempenho nas aulas deste mÃ³dulo?": 4,
        "Em uma escala de 1 a 5, como vocÃª avalia o professor 1 na conduÃ§Ã£o das aulas deste mÃ³dulo?": 5,
        "Em uma escala de 1 a 5, como vocÃª avalia o professor 2 na conduÃ§Ã£o das aulas deste mÃ³dulo?": 5,
        "Que bom (O que vocÃª gostou)": "A forma que as aulas sÃ£o explicadas, de uma forma fÃ¡cil de entender, descontraÃ­da, e muito interessante",
        "Que tal (O que poderia ser melhor)": "Mais dias de aula desse tema para que possamos aprender ainda mais sobre as emoÃ§Ãµes",
        "Que pena (O que vocÃª nÃ£o gostou)": "Nada"
      }
    ]
  }
};
  </script>

  <script src="script.js"></script>
</body>
</html>
